import org.sikuli.script.*;

public class FetchStatusBarSum {
    public static void main(String[] args) {
        Screen s = new Screen();

        try {
            // Step 1: Select the range of cells in Excel
            // Assume that we select cells from A1 to A10 (you can adjust coordinates as needed)
            s.dragDrop(new Location(100, 200), new Location(100, 400));  // Adjust coordinates

            // Step 2: Locate the Excel status bar
            // You will need to take a screenshot of the area where the sum appears and save it as "statusBar.png"
            // Example: The sum text like "Sum: 848494839393" appears in the bottom-right corner of Excel.
            Match statusBar = s.find("statusBar.png");  // Ensure this image is a screenshot of the part of the status bar where the sum appears

            if (statusBar != null) {
                // Step 3: Use OCR to extract the sum from the status bar
                String sumText = statusBar.text();  // This uses OCR to get the text from the matched region
                System.out.println("Status bar sum: " + sumText);

                // Extract the numeric part from the sum text
                String sumValue = sumText.replaceAll("[^0-9]", "");  // Remove any non-numeric characters
                System.out.println("Extracted sum value: " + sumValue);
            } else {
                System.out.println("Status bar not found.");
            }

        } catch (FindFailed e) {
            e.printStackTrace();
        }
    }
}