import java.util.regex.*;
import org.sikuli.script.*;

public class FetchStatusBarSum {
    public static void main(String[] args) {
        Screen s = new Screen();

        try {
            // Step 1: Select the range of cells in Excel
            s.dragDrop(new Location(100, 200), new Location(100, 400));  // Adjust coordinates

            // Step 2: Locate the Excel status bar image
            Match statusBar = s.find("statusBar.png");

            if (statusBar != null) {
                // Step 3: Use OCR to extract the sum from the status bar
                String sumText = statusBar.text();  // OCR text from the status bar
                System.out.println("Raw OCR text: " + sumText);

                // Step 4: Use regex to extract the numeric portion, including commas and dots
                Pattern pattern = Pattern.compile("\\d{1,3}(,\\d{3})*(\\.\\d+)?");  
                Matcher matcher = pattern.matcher(sumText);

                if (matcher.find()) {
                    String sumValue = matcher.group();  // Extracted numeric value with commas and dots
                    System.out.println("Extracted sum value: " + sumValue);
                } else {
                    System.out.println("No matching sum value found in status bar text.");
                }
            } else {
                System.out.println("Status bar not found.");
            }

        } catch (FindFailed e) {
            e.printStackTrace();
        }
    }
}