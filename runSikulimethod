import { execFile } from "child_process";

export class SikuliUtil {
  private static readonly jarPath = "libs/sikuliUtility-1.0-SNAPSHOT-jar-with-dependencies.jar";

  static runSikuli(method: string, args: string[] = []): Promise<string> {
    return new Promise((resolve, reject) => {
      execFile(
        "java",
        ["-jar", this.jarPath, method, ...args],
        (error, stdout, stderr) => {
          if (error) {
            console.error("‚ö†Ô∏è Sikuli Error:", stderr || error.message);
            reject(new Error(stderr || error.message));
            return; // ‚¨ÖÔ∏è added to stop execution after reject
          }

          const output = stdout.trim(); // ‚¨ÖÔ∏è ensures no newlines or spaces
          console.log("üü¢ Sikuli Output:", output);
          resolve(output);
        }
      );
    });
  }
}